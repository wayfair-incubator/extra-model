name: Publish Release
env:
  PYTHON_VERSION: "3.9"
on:
  release:
    types: [published]
jobs:
  build-and-publish-wheel-to-pypi:
    runs-on: "ubuntu-latest"
    environment: "Publish Release"
    steps:
      - name: "Check out code"
        uses: "actions/checkout@v3"

      - uses: "actions/setup-python@v4.1.0"
        with:
          python-version: ${{ env.PYTHON_VERSION }}

      - name: "Build wheel"
        uses: "./.github/actions/build-dist"

        # v1.4.2 release. Using full SHA for security
        # https://docs.github.com/en/actions/learn-github-actions/security-hardening-for-github-actions#using-third-party-actions
      - name: "Publish distribution ðŸ“¦ to PyPI"
        uses: "pypa/gh-action-pypi-publish@37f50c210e3d2f9450da2cd423303d6a14a6e29f"
        with:
          password: ${{ secrets.PYPI_API_TOKEN }}
